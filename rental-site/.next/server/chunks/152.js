"use strict";exports.id=152,exports.ids=[152],exports.modules={13186:(a,b,c)=>{c.d(b,{J:()=>f});var d=c(38301),e=c(90727);function f(){let[a,b]=(0,d.useState)(!1),[c,f]=(0,d.useState)(null),[g,h]=(0,d.useState)(null);return(0,d.useCallback)(a=>{switch(console.log("Received real-time event:",a),f(a),a.type){case"availability.changed":case"vehicle.updated":case"price.updated":a.data?.vehicle_id&&((0,e.j)(["equipment",a.data.vehicle_id]),(0,e.j)(b=>Array.isArray(b)&&"availability"===b[0]&&b[1]===a.data.vehicle_id,void 0,{revalidate:!0})),(0,e.j)(a=>"equipment"===a||Array.isArray(a)&&"equipment"===a[0]);break;case"vehicle.added":case"vehicle.removed":(0,e.j)(a=>"equipment"===a||Array.isArray(a)&&"equipment"===a[0]),(0,e.j)("featured-equipment");break;case"booking.created":case"booking.confirmed":case"booking.cancelled":a.data?.vehicle_id&&(0,e.j)(b=>Array.isArray(b)&&"availability"===b[0]&&b[1]===a.data.vehicle_id,void 0,{revalidate:!0});break;case"heartbeat":break;default:console.log("Unhandled event type:",a.type)}},[]),{connected:a,lastEvent:c,error:g}}},53028:(a,b,c)=>{c.d(b,{cA:()=>g,nB:()=>f,pk:()=>e});var d=c(58589);async function e(a){let b=await (0,d.Vg)("/api/fleet/vehicles",a);return b.success&&b.data?b:{success:!1,data:[],pagination:{total:0,limit:a?.limit||20,offset:a?.offset||0,has_more:!1}}}async function f(a){let b=await (0,d.Vg)(`/api/fleet/vehicle/${a}`);if(!b.success||!b.data)throw Error("Equipment not found");return b.data}function g(a){let b;b=a.primary_image&&a.primary_image.startsWith("http")?a.primary_image:`/web/image/fleet.vehicle/${a.id}/image_1920`;let c="Equipment";if(a.category){console.log("Odoo category value:",a.category,"for vehicle:",a.name);let b={skidsteer:"Skid Steers",skid_steer:"Skid Steers","skid steer":"Skid Steers","skid steers":"Skid Steers",excavator:"Excavators",excavators:"Excavators",mini_excavator:"Excavators","mini excavator":"Excavators",trailer:"Trailers",trailers:"Trailers",dump_trailer:"Trailers","dump trailer":"Trailers",equipment_trailer:"Trailers","equipment trailer":"Trailers",loader:"Loaders",loaders:"Loaders",wheel_loader:"Loaders","wheel loader":"Loaders",backhoe:"Loaders",power_tool:"Power Tools","power tool":"Power Tools","power tools":"Power Tools",chainsaw:"Power Tools",generator:"Power Tools",compressor:"Power Tools",attachment:"Attachments",attachments:"Attachments"}[a.category.toLowerCase()];b?c=b:console.warn(`Unknown category '${a.category}' for vehicle '${a.name}', using default 'Equipment'`)}else if(a.name){let b=a.name.toLowerCase();b.includes("cat")||b.includes("skid")?c="Skid Steers":b.includes("excavator")||b.includes("mini ex")?c="Excavators":b.includes("trailer")?c="Trailers":b.includes("loader")||b.includes("backhoe")?c="Loaders":(b.includes("chainsaw")||b.includes("generator")||b.includes("compressor")||b.includes("tool"))&&(c="Power Tools")}return{id:a.id,name:a.name||"Equipment",category:c,description:"",hourly_rate:Math.round(a.rental_price_daily/8),daily_rate:a.rental_price_daily||0,weekly_rate:a.rental_price_weekly||5*a.rental_price_daily,available:"available"===a.availability_status,image_url:b}}},58589:(a,b,c)=>{c.d(b,{$P:()=>g,Vg:()=>f,uE:()=>e});class d extends Error{constructor(a,b,c){super(a),this.status=b,this.data=c,this.name="ApiError"}}async function e(a,b){let{params:c,retries:e=3,retryDelay:f=1e3,...g}=b||{},h=new URL(`https://lco.axsys.app${a}`);c&&Object.entries(c).forEach(([a,b])=>{null!=b&&h.searchParams.append(a,String(b))});let i={"Content-Type":"application/json",...g.headers||{}},j=process.env.ODOO_API_KEY;j&&(i["X-API-Key"]=j);let k=null;for(let a=0;a<e;a++)try{let b=await fetch(h.toString(),{...g,headers:i}),c=await b.json();if(!b.ok){if(b.status>=400&&b.status<500)throw new d(c.error||`API Error: ${b.statusText}`,b.status,c);if(b.status>=500&&(k=new d(c.error||`Server Error: ${b.statusText}`,b.status,c),a<e-1)){await new Promise(b=>setTimeout(b,f*Math.pow(2,a)));continue}}return c}catch(b){if(b instanceof d&&b.status&&b.status<500)throw b;if(k=b instanceof Error?b:Error("An unknown error occurred"),a<e-1){await new Promise(b=>setTimeout(b,f*Math.pow(2,a)));continue}}throw k||new d("Request failed after multiple retries")}let f=(a,b)=>e(a,{method:"GET",params:b}),g=(a,b)=>e(a,{method:"POST",body:b?JSON.stringify(b):void 0})},78755:(a,b,c)=>{c.d(b,{Cy:()=>g});var d=c(51459),e=c(53028);c(95719);let f={revalidateOnFocus:!1,revalidateOnReconnect:!0,dedupingInterval:3e4};function g(a){let{data:b,error:c,isLoading:g,mutate:h}=(0,d.Ay)(a?["equipment",a]:"equipment",()=>(0,e.pk)(a),{...f,refreshInterval:6e4});return{equipment:b?.data||[],pagination:b?.pagination,isLoading:g,isError:c,error:c,refresh:h}}},95719:(a,b,c)=>{c.d(b,{q0:()=>e,sH:()=>f});var d=c(58589);async function e(a){try{let b=await (0,d.$P)("/api/fleet/availability",a);if(void 0!==b.success)return b;return{success:!0,...b}}catch(b){return console.error("Availability check failed:",b),{success:!1,available:!1,vehicle_id:a.vehicle_id,days:0,estimated_price:0,daily_rate:0,currency:"USD"}}}async function f(a){let b=new Date(a.date_from),c=new Date(a.date_to),e=new Date;if(e.setHours(0,0,0,0),b>=c)throw Error("End date must be after start date");if(b<e)throw Error("Start date cannot be in the past");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.customer_email))throw Error("Invalid email address");if(!/^[\d\s\-\+\(\)]+$/.test(a.customer_phone))throw Error("Invalid phone number");try{let b=await (0,d.uE)("/api/fleet/booking",{method:"POST",body:JSON.stringify(a),retries:1});if(void 0!==b.success)return b;return{success:!0,...b}}catch(a){if(409===a.status)throw Error(a.data?.message||"This vehicle is not available for the selected dates");throw a}}}};